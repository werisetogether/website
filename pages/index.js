import Head from 'next/head';
import Layout from '../Components/Layout';
import Header from '../Components/Header';
import ProjectSnip from '../Components/ProjectSnip';
import AboutSnip from '../Components/AboutSnip';
import DonateSnip from '../Components/DonateSnip';
import { createClient } from "contentful";
import Link from "next/link";

export async function getStaticProps() {
  const client = createClient({
    space: process.env.CONTENTFUL_SPACE_ID,
    accessToken: process.env.CONTENTFUL_ACCESS_KEY,
  });

  const abouts = await client.getEntries({ content_type: "homepageAbout" });
  const projects = await client.getEntries({
    content_type: "singleProject",
    limit: 2,
  });

  return {
    props: {
      abouts: abouts.items,
      projects: projects.items,
    },
  };
}

export default function Home({ abouts, projects }) {
  return (
    <div>
      <div>
        <Head>
          <title>WeRiseTogether</title>
          <meta name="description" content="Generated by create next app" />
          <link rel="icon" href="/favicon.icon" />
        </Head>
        <main>
          <Layout>
            <Header />
            <div className="max-w-4xl mx-auto">
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-5 items-center">
                {projects.map((project) => (
                  <ProjectSnip key={project.sys.id} project={project} />
                ))}
                <Link href="/projects">
                  <a className="sm:col-span-3">
                    <button className="focus:outline-none border-2 border-black rounded-xl px-8 py-4 text-lg sm:text-xl font-semibold flex justify-center w-full h-full items-center">
                      Learn more
                    </button>
                  </a>
                </Link>
              </div>
              {abouts.map((about) => (
                <AboutSnip key={about.sys.id} about={about} />
              ))}
              <DonateSnip />
            </div>
          </Layout>
        </main>
      </div>
    </div>
  );
}
